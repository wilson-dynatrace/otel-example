Simple demo application setup for PHP/Swoole monitoring using OpenTelemetry

Get Dynatrace OpenTelemetry Collector via

docker pull ghcr.io/dynatrace/dynatrace-otel-collector/dynatrace-otel-collector:0.38.0

Docker compose example:
services:
  collector:
    image: ghcr.io/dynatrace/dynatrace-otel-collector/dynatrace-otel-collector:0.32.0
    command: ["--config=/etc/otelcol/otel-collector-config.yml"]
    volumes:
      - ./otel-collector-config.yaml:/etc/otelcol/otel-collector-config.yaml
    ports:
      - "4317:4317"   # OTLP gRPC
      - "4318:4318"   # OTLP HTTP
    environment:
      - DT_ENDPOINT
      - DT_API_TOKEN

Collector configuration exanple:

receivers:
  otlp:
    protocols:
      grpc:
        endpoint: 0.0.0.0:4317
      http:
        endpoint: 0.0.0.0:4318

processors:
  cumulativetodelta:

exporters:
  otlphttp/dynatrace:
    endpoint: "${env:DT_ENDPOINT}"
    headers:
      Authorization: "Api-Token ${env:DT_API_TOKEN}"

service:
  pipelines:
    traces:
      receivers: [otlp]
      processors: [batch]
      exporters: [otlphttp/dynatrace]
    metrics:
      receivers: [otlp]
      processors: [cumulativetodelta]
      exporters: [otlphttp/dynatrace]
    logs:
      receivers: [otlp]
      processors: [batch]
      exporters: [otlphttp/dynatrace]

---
Preparation

1. In Dynatrace, create an access token with the Ingest scopes.
2. Setup the environment

export DT_ENDPOINT=https://{your-environment-id}.live.dynatrace.com/api/v2/otlp
export DT_API_TOKEN={your-api-token}
export NAME=k8s-otel-o11y

3. Setup Dynatrace OpenTelemetry Collector (https://github.com/Dynatrace/dynatrace-otel-collector)
Refer to https://docs.dynatrace.com/docs/ingest-from/opentelemetry/collector/deployment for setup details.
