x-default-logging: &logging
  driver: "json-file"
  options:
    max-size: "5m"
    max-file: "2"
    tag: "{{.Name}}"
    
networks:
  opentelemetry:
    name: opentelemetry
    driver: bridge
    external: true

services:
  # OpenTelemetry Collector
  otel-collector:
    image: ${COLLECTOR_CONTRIB_IMAGE}
    networks:
      - opentelemetry
    command: ["--config=/etc/otel-collector-config.yaml"]
    logging: *logging
    volumes:
      - ./src/otel-collector-config-dt.yaml:/etc/otel-collector-config.yaml
    ports:
      - "${OTEL_COLLECTOR_PORT_OTLP_GRPC}:4317"     # OTLP gRPC
      - "${OTEL_COLLECTOR_PORT_OTLP_HTTP}:4318"     # OTLP HTTP:
      - "${OTEL_COLLECTOR_PORT_DEBUG}:13133"        # health_check extension
